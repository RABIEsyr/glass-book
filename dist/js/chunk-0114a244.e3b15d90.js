(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0114a244"],{"11e0":function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-container",[s("v-row",{attrs:{"no-gutters":""}},[s("v-col",{staticClass:"pa-2",attrs:{cols:"12"}},[s("router-link",{attrs:{to:"/user/"+e.receiverId}},[s("h1",{staticClass:"head"},[e._v(e._s(e.receiverName))])]),s("main",{attrs:{id:"ap"}},[s("section",{ref:"chatArea",staticClass:"chat-area"},[s("v-container",e._l(e.messages,(function(t,o){return s("v-row",{key:t._id,attrs:{"no-gutters":""}},["you"!==t.author?[s("v-row",[s("p",{staticClass:"message",class:{"message-out":"you"===t.author,"message-in":"you"!==t.author&&"seen"==t.status,"message-in-sent":"you"!==t.author&&"sent"==t.status,"message-out-delete":t.deletearray.length>0},style:{"word-wrap":"break-word"},on:{click:function(t){return e.toggleVisibilityButtons(o)}}},[e._v(" "+e._s(t.body)+" ")]),e.visibleButtons[o]?s("h1",{on:{click:function(s){return e.deleteRestoreMessage(t._id,o)}}},[t.deletearray.includes(e.userID)?s("font-awesome-icon",{staticStyle:{color:"blue"},attrs:{icon:"redo"}}):e._e(),t.deletearray.includes(e.userID)?e._e():s("font-awesome-icon",{staticClass:"fa fa-trash",style:{color:t.deletearray.length>0?"red":"blue"},attrs:{icon:"trash"}})],1):e._e()])]:[s("v-row",{staticStyle:{background:"white"},style:{color:"black","margin-left":"40%"}},[e.visibleButtons[o]?s("h1",{on:{click:function(s){return e.deleteRestoreMessage(t._id,o)}}},[t.deletearray.includes(e.userID)?s("font-awesome-icon",{staticStyle:{color:"blue"},attrs:{icon:"redo"}}):e._e(),t.deletearray.includes(e.userID)?e._e():s("font-awesome-icon",{staticClass:"fa fa-trash",style:{color:t.deletearray.length>0?"red":"blue"},attrs:{icon:"trash"}})],1):e._e(),s("p",{staticClass:"message",class:{"message-out":"you"===t.author,"message-in":"you"!==t.author,"message-out-delete":t.deletearray.length>0},style:{"word-wrap":"break-word",float:"right"},on:{click:function(t){return e.toggleVisibilityButtons(o)}}},[e._v(" "+e._s(t.body)+" ")])])]],2)})),1)],1),s("section",{staticClass:"chat-inputs"},[s("form",{attrs:{id:"person1-form"},on:{submit:function(t){return t.preventDefault(),e.sendMessage()}}},[s("label",{attrs:{for:"person1-input"}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.bobMessage,expression:"bobMessage"}],attrs:{id:"person1-input",type:"text",placeholder:"Type your message",required:""},domProps:{value:e.bobMessage},on:{input:function(t){t.target.composing||(e.bobMessage=t.target.value)}}}),s("button",{attrs:{type:"submit"}},[s("font-awesome-icon",{staticStyle:{color:"#407FFF","margin-left":"5px"},attrs:{icon:"fas fa-paper-plane"}})],1)])])])],1)],1)],1),s("router-link",{attrs:{to:"/encr-private-chat/"+e.$route.params.receiverID}},[e._v(" E-E encryption ")])],1)},a=[],r=(s("99af"),s("4de4"),s("7db0"),s("d81d"),s("a434"),s("b0c0"),s("5530")),n=s("db49"),i=s("8055"),c=s.n(i),l=s("2f62"),u=s("6e87"),d=s("bc3a"),g=s.n(d),m={data:function(){return{socket:c()(n["a"],{query:{token:localStorage.getItem("token")}}),bobMessage:"",youMessage:"",receiverName:"",receiverId:this.$route.params.receiverID,messages:[],windowWidth2:window.innerWidth,visibleButtons:[],userID:localStorage.getItem("userID"),urls:n["a"]}},methods:Object(r["a"])({sendMessage:function(){try{this.$store.dispatch("socketOnConnection",{msg:this.bobMessage,id:this.$route.params.receiverID})}catch(e){console.log("the error heree")}this.$nextTick((function(){document.getElementsByClassName("chat-area")[0].scrollTop}))},onResize:function(){console.log("App.vue-onResize()",this.windowWidth2),this.windowWidth2=window.innerWidth},toggleVisibilityButtons:function(e){this.$set(this.visibleButtons,e,!this.visibleButtons[e]),console.log(this.visibleButtons),console.log(this.messages[e])},deleteRestoreMessage:function(e,t){var s=this;console.log("message id is: ",e),g.a.post(this.urls+"/chat-message/delete-msg",{id:e,receiverID:this.$route.params.receiverID},{headers:{authorization:localStorage.getItem("token")}}).then((function(o){if(o.data.success){if(console.log("eee",o),"message confirm delete"==o.data.message&&(s.messages.splice(t,1),s.visibleButtons.splice(t,1)),"message delete request"==o.data.message){var a=s.messages.find((function(t){return t._id===e}));a&&a.deletearray.push(localStorage.getItem("userID"))}if("message restore"==o.data.message){var r=s.messages.find((function(t){return t._id===e}));r&&(r.deletearray=[])}}console.log(o)}))}},Object(l["b"])({getChatMessage:u["i"]})),computed:Object(r["a"])({},Object(l["c"])({getMessages:u["i"]})),watch:{windowWidth2:function(e,t){var s="it changed to ".concat(t," from ").concat(e);console.log("sxxx",s)}},created:function(){var e=this;g.a.get(this.urls+"/chat-message/"+this.$route.params.receiverID,{headers:{authorization:localStorage.getItem("token")}}).then((function(t){console.log("msgd22",t.data);var s=t.data;s.map((function(t){return t.from==localStorage.getItem("userID")?(console.log("0000",localStorage.getItem("userID"),"0000",t.from),e.messages.push({body:t.text,author:"bob",_id:t._id,deletearray:t.delete,status:t.status}),e.$nextTick((function(){document.getElementsByClassName("chat-area")[0].scrollTop="1111111111111111111111111111"})),{body:t.text,author:"bob"}):(e.messages.push({body:t.text,author:"you",_id:t._id,deletearray:t.delete,status:t.status}),{body:t.text,author:"you"})})),console.log("444",e.messages)})),this.socket.on("msg",(function(t){t.senderId==localStorage.getItem("userID")?(console.log("ChatOneToOne new message 2026",t),e.messages.push({body:t.msg,author:"bob",deletearray:t.delete,_id:t._id,status:t.status}),e.$nextTick((function(){document.getElementsByClassName("chat-area")[0].scrollTop="1111111111111111111111111111"}))):t.senderId==e.$route.params.receiverID&&(console.log("ChatOneToOne new message 2025",t),e.messages.push({body:t.msg,author:"you",deletearray:t.delete,_id:t._id,status:t.status}),e.$nextTick((function(){document.getElementsByClassName("chat-area")[0].scrollTop="1111111111111111111111111111"})))})),this.socket.emit("current-url",this.$route.params.receiverID),this.socket.on("message_deleted_request",(function(t){console.log("message_deleted_request",t);var s=e.messages.find((function(e){return e._id===t.messageId}));s&&s.deletearray.push(e.$route.params.receiverID)})),this.socket.on("message_restore",(function(t){console.log("message_restore",t);var s=e.messages.find((function(e){return e._id===t.messageId}));s&&(s.deletearray=[])})),this.socket.on("message_delete_permenant",(function(t){console.log("message_deleted_permanent",t),e.messages=e.messages.filter((function(e){return e._id!==t.messageId}))})),this.socket.on("message-seen",(function(t){if(console.log("new sseenn",t),t==e.$route.params.receiverID){var s=e.messages.length-1;console.log("seen message all: ",t,"arryChatLength: ",s);for(var o=s;o>=0;o--)console.log("oooooooooooooo",o),"seen"==e.messages[o].status?console.log("eeeeerrrrrrr"):e.messages[o].status="seen"}})),g.a.post(this.urls+"/users/get-name-chat",{id:this.$route.params.receiverID},{headers:{authorization:localStorage.getItem("token")}}).then((function(t){e.receiverName=t.data.name})),this.$route.params.receiverID==localStorage.getItem("userID")&&this.$router.push("/"),g.a.post(this.urls+"/get-all-messages/read-message",{receiverId:this.$route.params.receiverID},{headers:{authorization:localStorage.getItem("token")}}).then((function(t){e.socket.emit("new-post",t)})),this.socket.emit("some","some"),g.a.post(this.urls+"/seen/see-all-message",{senderId:this.$route.params.receiverID},{headers:{authorization:localStorage.getItem("token")}}).then((function(e){console.log("seen result",e)}))},mounted:function(){var e=this;this.socket.emit("current-url",this.$route.params.receiverID),this.$nextTick((function(){window.addEventListener("resize",e.onResize),e.socket.emit("current-url",e.$route.params.receiverID)}))},updated:function(){this.socket.emit("current-url",this.$route.params.receiverID)},destroyed:function(){this.messages=[],this.$store.dispatch(u["v"]),this.socket.emit("current-url",null),window.removeEventListener("resize",this.onResize)}},h=m,f=(s("26fd"),s("2877")),p=s("6544"),v=s.n(p),b=s("62ad"),y=s("a523"),I=s("0fd9"),w=Object(f["a"])(h,o,a,!1,null,"4b37680a",null);t["default"]=w.exports;v()(w,{VCol:b["a"],VContainer:y["a"],VRow:I["a"]})},"26fd":function(e,t,s){"use strict";var o=s("2a8e"),a=s.n(o);a.a},"2a8e":function(e,t,s){}}]);
//# sourceMappingURL=chunk-0114a244.e3b15d90.js.map