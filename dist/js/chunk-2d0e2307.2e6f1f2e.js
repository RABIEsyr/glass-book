(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e2307"],{"7e47":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"video-container"},[n("button",{on:{click:function(t){return e.callUser()}}},[e._v("Call")]),n("div",[e._m(0),n("div",{staticStyle:{position:"absolute"}},[n("h1",{staticStyle:{position:"absolute","z-index":"11","margin-left":"500px"}},[e._v(e._s(e.calleName))]),n("video",{staticClass:"remote-video",staticStyle:{position:"absolute"},attrs:{autoplay:"",muted:"",id:"remote-video"},domProps:{muted:!0}})])])])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{position:"absolute",width:"50px",height:"50px","z-index":"11"}},[n("video",{staticClass:"local-video",staticStyle:{position:"absolute",width:"250px"},attrs:{autoplay:"",id:"local-video"}})])}],o=(n("4160"),n("b0c0"),n("159b"),n("3835")),c=(n("96cf"),n("1da1")),i=n("5530"),s=n("db49"),u=n("8055"),l=n.n(u),p=n("2f62"),d=window,m=d.RTCSessionDescription,f={data:function(){return{socket:l()(s["a"],{query:{token:localStorage.getItem("token")}}),calleName:""}},computed:Object(i["a"])({},Object(p["c"])({peerConnectionState:"getRtcPeerConnection"})),created:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.calleName=e.$route.params.name,n=null,t.prev=2,t.next=5,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 5:n=t.sent,r=document.getElementById("local-video"),r&&(r.srcObject=n),n.getTracks().forEach((function(t){return e.peerConnectionState.addTrack(t,n)})),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),alert(t.t0);case 14:e.peerConnectionState.ontrack=function(e){var t=Object(o["a"])(e.streams,1),n=t[0],r=document.getElementById("remote-video");r&&(r.srcObject=n)},e.socket.on("call-made",function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.peerConnectionState.setRemoteDescription(new m(n.offer));case 2:return t.next=4,e.peerConnectionState.createAnswer();case 4:return r=t.sent,t.next=7,e.peerConnectionState.setLocalDescription(new m(r));case 7:e.socket.emit("make-answer",{answer:r,to:n.socket});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.socket.on("answer-made",function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.peerConnectionState.setRemoteDescription(new m(n.answer));case 2:e.callUser();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.$route.params.caller&&(a=e,setTimeout((function(){a.callUser()}),4e3));case 18:case"end":return t.stop()}}),t,null,[[2,11]])})))()},methods:{callUser:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.peerConnectionState.createOffer();case 2:return n=t.sent,t.next=5,e.peerConnectionState.setLocalDescription(new m(n));case 5:e.socket.emit("call-user",{offer:n,to:e.$route.params.id});case 6:case"end":return t.stop()}}),t)})))()}}},v=f,w=n("2877"),h=Object(w["a"])(v,r,a,!1,null,"79e5b1aa",null);t["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d0e2307.2e6f1f2e.js.map