{"version":3,"sources":["webpack:///./src/components/chat/VideoCall.vue?eab7","webpack:///src/components/chat/VideoCall.vue","webpack:///./src/components/chat/VideoCall.vue?04a5","webpack:///./src/components/chat/VideoCall.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","$event","callUser","_v","_m","staticStyle","_s","calleName","attrs","domProps","staticRenderFns","query","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,SAAS,CAACG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIS,cAAc,CAACT,EAAIU,GAAG,UAAUN,EAAG,MAAM,CAACJ,EAAIW,GAAG,GAAGP,EAAG,MAAM,CAACQ,YAAY,CAAC,SAAW,aAAa,CAACR,EAAG,KAAK,CAACQ,YAAY,CAAC,SAAW,WAAW,UAAU,KAAK,cAAc,UAAU,CAACZ,EAAIU,GAAGV,EAAIa,GAAGb,EAAIc,cAAcV,EAAG,QAAQ,CAACE,YAAY,eAAeM,YAAY,CAAC,SAAW,YAAYG,MAAM,CAAC,SAAW,GAAG,MAAQ,GAAG,GAAK,gBAAgBC,SAAS,CAAC,OAAQ,YACriBC,EAAkB,CAAC,WAAa,IAAIjB,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACQ,YAAY,CAAC,SAAW,WAAW,MAAQ,OAAO,OAAS,OAAO,UAAU,OAAO,CAACR,EAAG,QAAQ,CAACE,YAAY,cAAcM,YAAY,CAAC,SAAW,WAAW,MAAQ,SAASG,MAAM,CAAC,SAAW,GAAG,GAAK,qB,+HCsB5T,S,EAAA,sBAIA,GACE,KAAF,kBAEM,OAAN,YACQG,MAAO,CAAf,uCAEA,eAEE,SAAF,kBACA,gBACI,oBAAJ,0BAGE,QAbF,WAaA,yKACA,iCAEA,OAHA,kBAKA,yDALA,OAKA,EALA,OAMA,yCACA,IACA,eACA,iFATA,qDAWA,YAXA,QAeA,mFACA,0CACA,IACA,gBAIA,sMAEA,2DAFA,uBAGA,qCAHA,cAGA,EAHA,gBAIA,oDAJA,OAKA,6BACA,SACA,cAPA,kGAWA,kMACA,4DADA,OAGA,aAHA,kGAOA,yBACA,IACA,uBACA,eACA,MA5CA,6DA+CE,QAAF,CAII,SAJJ,WAIM,IAAN,OAAM,OAAN,4JACA,oCADA,cACA,EADA,gBAEA,oDAFA,OAGA,2BACA,QACA,wBALA,gDC3FkW,I,YCO9VC,EAAY,eACd,EACApB,EACAkB,GACA,EACA,KACA,WACA,MAIa,aAAAE,E","file":"js/chunk-2d0e2307.2e6f1f2e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"video-container\"},[_c('button',{on:{\"click\":function($event){return _vm.callUser()}}},[_vm._v(\"Call\")]),_c('div',[_vm._m(0),_c('div',{staticStyle:{\"position\":\"absolute\"}},[_c('h1',{staticStyle:{\"position\":\"absolute\",\"z-index\":\"11\",\"margin-left\":\"500px\"}},[_vm._v(_vm._s(_vm.calleName))]),_c('video',{staticClass:\"remote-video\",staticStyle:{\"position\":\"absolute\"},attrs:{\"autoplay\":\"\",\"muted\":\"\",\"id\":\"remote-video\"},domProps:{\"muted\":true}})])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"position\":\"absolute\",\"width\":\"50px\",\"height\":\"50px\",\"z-index\":\"11\"}},[_c('video',{staticClass:\"local-video\",staticStyle:{\"position\":\"absolute\",\"width\":\"250px\"},attrs:{\"autoplay\":\"\",\"id\":\"local-video\"}})])}]\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"video-container\">\r\n        <!-- <div>\r\n            <font-awesome-icon icon=\"phone\" class='fa fa-phone faa-ring animated fa-2x'></font-awesome-icon>\r\n        </div> -->\r\n        <button @click=\"callUser()\">Call</button>\r\n           <div>\r\n            <div style=\"position: absolute; width:50px; height: 50px; z-index: 11\">\r\n               <!-- <h1 style=\"position: absolute; z-index: 11\">YOU</h1> -->\r\n               <video style=\"position: absolute; width: 250px\" autoplay class=\"local-video\" id=\"local-video\"></video>\r\n            </div>\r\n            <div style=\"position: absolute\">\r\n                <h1 style=\"position: absolute; z-index: 11; margin-left: 500px\">{{calleName}}</h1>\r\n                <video style=\"position: absolute\" autoplay muted class=\"remote-video\" id=\"remote-video\"></video>\r\n            </div>\r\n           </div>\r\n         </div>\r\n</template>\r\n\r\n<script>\r\nimport serverUrl from '../../config';\r\nimport io from \"socket.io-client\";\r\nimport {mapGetters} from 'vuex';\r\n const {  RTCSessionDescription } = window;\r\n//  const peerConnection = new RTCPeerConnection();\r\n\r\n//  let isAlreadyCalling = false;\r\nexport default {\r\n   data: () => ({\r\n    //    socket: io(\"http://localhost:3000\", {\r\n       socket: io(serverUrl, {\r\n        query: { token: localStorage.getItem(\"token\") },\r\n    }),\r\n    calleName: '',\r\n   }),\r\n   computed: {\r\n       ...mapGetters({\r\n           peerConnectionState: 'getRtcPeerConnection'\r\n       })\r\n   }, \r\n   async created() {\r\n      this.calleName = this.$route.params.name;\r\n      \r\n      let stream = null;\r\n      try {\r\n          stream = await navigator.mediaDevices.getUserMedia({video: true, audio: true});\r\n          const localVideo = document.getElementById('local-video');\r\n          if (localVideo)\r\n             localVideo.srcObject = stream;\r\n          stream.getTracks().forEach((track) => this.peerConnectionState.addTrack(track, stream))\r\n      } catch (error) {\r\n          alert(error)\r\n      }\r\n\r\n    \r\n        this.peerConnectionState.ontrack = function({streams: [stream]}) {\r\n           const remoteVideo = document.getElementById('remote-video');\r\n           if (remoteVideo) {\r\n                remoteVideo.srcObject = stream;\r\n           }\r\n       } \r\n       \r\n       this.socket.on('call-made', async (data) => {\r\n        //    this.setIngoingCall(true);\r\n           await this.peerConnectionState.setRemoteDescription(new RTCSessionDescription(data.offer));\r\n           const answer = await this.peerConnectionState.createAnswer();\r\n           await this.peerConnectionState.setLocalDescription(new RTCSessionDescription(answer));\r\n           this.socket.emit('make-answer', {\r\n               answer,\r\n               to: data.socket\r\n           });\r\n       })\r\n\r\n       this.socket.on('answer-made', async data => {\r\n           await this.peerConnectionState.setRemoteDescription(new RTCSessionDescription(data.answer));\r\n        //    if (!isAlreadyCalling) {\r\n                this.callUser();\r\n        //        isAlreadyCalling = true;\r\n        //    }\r\n       })\r\n       if (this.$route.params.caller) {\r\n            const self = this;\r\n            setTimeout(function() {\r\n                self.callUser();\r\n            }, 4000)\r\n        }  \r\n   },\r\n   methods: {\r\n    //    ...mapMutations({\r\n    //        setIngoingCall: 'IngoingCall'\r\n    //    }),\r\n       async callUser() {\r\n           const offer = await this.peerConnectionState.createOffer();\r\n           await this.peerConnectionState.setLocalDescription(new RTCSessionDescription(offer));\r\n           this.socket.emit('call-user', {\r\n               offer,\r\n               to: this.$route.params.id\r\n           })\r\n       },\r\n\r\n   }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoCall.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoCall.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./VideoCall.vue?vue&type=template&id=79e5b1aa&scoped=true&\"\nimport script from \"./VideoCall.vue?vue&type=script&lang=js&\"\nexport * from \"./VideoCall.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"79e5b1aa\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}